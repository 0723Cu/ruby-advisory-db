---
gem: actionpack
framework: rails
cve: 2014-0130
url: https://groups.google.com/forum/#!topic/ruby-security-ann/9WiRn2nhfq0
title: Directory Traversal Vulnerability With Certain Route Configurations
date: 2014-05-06

description: |
  There is a vulnerability in the 'implicit render'
  functionality in Ruby on Rails.The implicit render functionality
  allows controllers to render a template, even if there is no
  explicit action with the corresponding name.  This module does not
  perform adequate input sanitization which could allow an attacker to
  use a specially crafted request to retrieve arbitrary files from the
  rails application server.

  In order to be vulnerable an application must specifically use
  globbing routes in combination with the :action parameter.  The
  purpose of the route globbing feature is to allow parameters to
  contain characters which would otherwise be regarded as separators,
  for example '/' and '.'.  As these characters have semantic meaning
  within template filenames, it is highly unlikely that applications
  are deliberately combining these functions.

  To determine if you are vulnerable, search your application's routes
  files for '*action' and if you find any, use one of the work arounds
  below.
 

cvss_v2: 

patched_versions:
  - ~> 3.2.18
  - ~> 4.0.5
  - ">= 4.1.1"
